<div class="module-container">

  <!-- HEADER: Sticky top - ◊õ◊ï◊™◊®◊™ + ◊õ◊§◊™◊ï◊® ◊î◊ï◊°◊§◊î + ◊§◊ô◊ú◊ò◊®◊ô◊ù -->
  <div class="module-header">
    <div class="header-top">
      <h1>{{ (i18n.terms$ | async)?.donorListTitle }}</h1>
      <button class="btn btn-primary add-donor-btn" (click)="createDonor()">
        {{ (i18n.terms$ | async)?.addNewDonor }}
      </button>
    </div>

    <div class="filters-section">
      <div class="filter-row">
        <div class="filter-group">
          <label>{{ (i18n.terms$ | async)?.generalSearch }}</label>
          <input
            type="text"
            class="form-control"
            [placeholder]="(i18n.terms$ | async)?.searchNameAddressPhone"
            [(ngModel)]="searchTerm"
            (ngModelChange)="onLocalFilterChange()">
        </div>
      </div>
    </div>
  </div>

  <!-- CONTENT: ◊ê◊ñ◊ï◊® ◊î◊™◊ï◊õ◊ü ◊î◊û◊®◊õ◊ñ◊ô -->
  <div class="module-content">

    <!-- Table Header: Sticky top ◊©◊ú ◊î◊ò◊ë◊ú◊î -->
    <div class="table-header">
      <div class="grid-col sortable" [class.sorted]="isSorted('fullName')" (click)="toggleSort('fullName', $event)">
        {{ (i18n.terms$ | async)?.name }}
        <span class="sort-icon" *ngIf="getSortIcon('fullName')">{{ getSortIcon('fullName') }}</span>
      </div>
      <div class="grid-col sortable" [class.sorted]="isSorted('address')" (click)="toggleSort('address', $event)">
        {{ (i18n.terms$ | async)?.address }}
        <span class="sort-icon" *ngIf="getSortIcon('address')">{{ getSortIcon('address') }}</span>
      </div>
      <div class="grid-col sortable" [class.sorted]="isSorted('phone')" (click)="toggleSort('phone', $event)">
        {{ (i18n.terms$ | async)?.phone }}
        <span class="sort-icon" *ngIf="getSortIcon('phone')">{{ getSortIcon('phone') }}</span>
      </div>
      <div class="grid-col sortable" [class.sorted]="isSorted('email')" (click)="toggleSort('email', $event)">
        {{ (i18n.terms$ | async)?.email }}
        <span class="sort-icon" *ngIf="getSortIcon('email')">{{ getSortIcon('email') }}</span>
      </div>
      <div class="grid-col sortable" [class.sorted]="isSorted('totalDonations')" (click)="toggleSort('totalDonations', $event)">
        {{ (i18n.terms$ | async)?.totalDonationsHeader }}
        <span class="sort-icon" *ngIf="getSortIcon('totalDonations')">{{ getSortIcon('totalDonations') }}</span>
      </div>
      <div class="grid-col sortable" [class.sorted]="isSorted('createdDate')" (click)="toggleSort('createdDate', $event)">
        {{ (i18n.terms$ | async)?.lastDonation }}
        <span class="sort-icon" *ngIf="getSortIcon('createdDate')">{{ getSortIcon('createdDate') }}</span>
      </div>
      <div class="grid-col">{{ (i18n.terms$ | async)?.actions }}</div>
    </div>

    <!-- Table Body: ◊î◊ó◊ú◊ß ◊î◊ô◊ó◊ô◊ì ◊©◊†◊í◊ú◊ú -->
    <div class="table-body">
      <div class="loading-overlay" *ngIf="loading">
        <div class="spinner">◊ò◊ï◊¢◊ü...</div>
      </div>

      <div class="grid-row" *ngFor="let donor of filteredDonors">
        <div class="grid-col">
          <div class="donor-name">
            <strong>{{donor.fullName}}</strong>
            <small *ngIf="donor.idNumber">({{ (i18n.terms$ | async)?.idNumberShort }}: {{donor.idNumber}})</small>
          </div>
        </div>
        <div class="grid-col">{{getDonorAddress(donor.id)}}</div>
        <div class="grid-col">{{getDonorPhone(donor.id)}}</div>
        <div class="grid-col">{{getDonorEmail(donor.id)}}</div>
        <div class="grid-col">{{getDonorTotalDonations(donor.id) | number:'1.2-2'}}</div>
        <div class="grid-col">{{donor.createdDate | date:'dd/MM/yyyy'}}</div>
        <div class="grid-col actions">
          <button class="btn-icon btn-edit" (click)="editDonor(donor)" [title]="(i18n.terms$ | async)?.edit">‚úè</button>
          <button class="btn-icon btn-delete" (click)="deleteDonor(donor)" [title]="(i18n.terms$ | async)?.delete">üóë</button>
        </div>
      </div>

      <div class="no-data" *ngIf="!loading && filteredDonors.length === 0">
        <p>{{ (i18n.terms$ | async)?.noDataFound }}</p>
      </div>
    </div>

    <!-- Table Footer: Sticky bottom - Pagination -->
    <div class="table-footer">
      <div class="pagination-controls">
        <button
          class="btn-page"
          (click)="firstPage()"
          [disabled]="currentPage === 1 || loading">
          ‚èÆ {{ (i18n.terms$ | async)?.first }}
        </button>

        <button
          class="btn-page"
          (click)="previousPage()"
          [disabled]="currentPage === 1 || loading">
          ‚Üê {{ (i18n.terms$ | async)?.previous }}
        </button>

        <div class="page-numbers">
          <button
            *ngFor="let page of getPageNumbers()"
            class="btn-page-number"
            [class.active]="page === currentPage"
            (click)="goToPage(page)"
            [disabled]="loading">
            {{page}}
          </button>
        </div>

        <button
          class="btn-page"
          (click)="nextPage()"
          [disabled]="currentPage === totalPages || loading">
          {{ (i18n.terms$ | async)?.next }} ‚Üí
        </button>

        <button
          class="btn-page"
          (click)="lastPage()"
          [disabled]="currentPage === totalPages || loading">
          {{ (i18n.terms$ | async)?.last }} ‚è≠
        </button>
      </div>

      <div class="pagination-info">
        <span>{{ (i18n.terms$ | async)?.showing }} {{(currentPage - 1) * pageSize + 1}} - {{Math.min(currentPage * pageSize, totalCount)}} {{ (i18n.terms$ | async)?.of }} {{totalCount}}</span>
      </div>
    </div>

  </div>

  <!-- FOOTER: Sticky bottom - (◊®◊ô◊ß ◊õ◊®◊í◊¢, ◊ú◊¢◊™◊ô◊ì) -->
  <div class="module-footer">
    <!-- ◊û◊ß◊ï◊ù ◊ú◊°◊ô◊õ◊ï◊û◊ô◊ù, ◊°◊ò◊ò◊ô◊°◊ò◊ô◊ß◊ï◊™, ◊ï◊õ◊ï' -->
  </div>

</div>

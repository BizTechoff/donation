<div class="reminders-container">
  <div class="page-header">
    <h1>{{ (i18n.terms$ | async)?.remindersAndTracking }}</h1>
    <button class="btn btn-primary add-reminder-btn" (click)="createReminder()">{{ (i18n.terms$ | async)?.addReminder }}</button>
  </div>

  <div class="summary-cards">
    <div class="summary-card today">
      <div class="card-icon">🔔</div>
      <div class="card-content">
        <h3>{{ (i18n.terms$ | async)?.todayReminders }}</h3>
        <span class="count urgent">{{todayReminders.length}}</span>
      </div>
    </div>
    <div class="summary-card this-week">
      <div class="card-icon">📅</div>
      <div class="card-content">
        <h3>{{ (i18n.terms$ | async)?.thisWeekReminders }}</h3>
        <span class="count">{{pendingReminders.length}}</span>
      </div>
    </div>
    <div class="summary-card overdue">
      <div class="card-icon">⚠️</div>
      <div class="card-content">
        <h3>{{ (i18n.terms$ | async)?.overdueReminders }}</h3>
        <span class="count urgent">{{overdueReminders.length}}</span>
      </div>
    </div>
    <div class="summary-card completed">
      <div class="card-icon">✅</div>
      <div class="card-content">
        <h3>{{ (i18n.terms$ | async)?.completedThisMonth }}</h3>
        <span class="count">{{completedRemindersCount}}</span>
      </div>
    </div>
  </div>

  <div class="filters-section">
    <div class="filter-row">
      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.reminderTypeFilter }}</label>
        <select class="form-control">
          <option value="">{{ (i18n.terms$ | async)?.everything }}</option>
          <option value="donation">{{ (i18n.terms$ | async)?.donationReminder }}</option>
          <option value="contact">{{ (i18n.terms$ | async)?.contactReminder }}</option>
          <option value="birthday">{{ (i18n.terms$ | async)?.birthdayReminder }}</option>
          <option value="memorial">{{ (i18n.terms$ | async)?.memorialReminder }}</option>
          <option value="meeting">{{ (i18n.terms$ | async)?.meetingReminder }}</option>
          <option value="follow-up">{{ (i18n.terms$ | async)?.followUpReminder }}</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.reminderStatusFilter }}</label>
        <select class="form-control">
          <option value="">{{ (i18n.terms$ | async)?.everything }}</option>
          <option value="pending">{{ (i18n.terms$ | async)?.pendingStatus }}</option>
          <option value="completed">{{ (i18n.terms$ | async)?.completedStatusReminder }}</option>
          <option value="overdue">{{ (i18n.terms$ | async)?.overdueStatus }}</option>
          <option value="cancelled">{{ (i18n.terms$ | async)?.cancelledStatusReminder }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.dateFromReminder }}</label>
        <input type="date" class="form-control">
      </div>

      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.dateToReminder }}</label>
        <input type="date" class="form-control">
      </div>

      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.donorSearchReminder }}</label>
        <input type="text" class="form-control" [placeholder]="(i18n.terms$ | async)?.donorNamePlaceholder">
      </div>

      <div class="filter-group">
        <label>{{ (i18n.terms$ | async)?.regionFilter }}</label>
        <select class="form-control">
          <option value="">{{ (i18n.terms$ | async)?.everything }}</option>
          <option value="center">{{ (i18n.terms$ | async)?.centerRegion }}</option>
          <option value="north">{{ (i18n.terms$ | async)?.northRegion }}</option>
          <option value="south">{{ (i18n.terms$ | async)?.southRegion }}</option>
          <option value="jerusalem">{{ (i18n.terms$ | async)?.jerusalemRegion }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label>מפרשה</label>
        <select class="form-control" [(ngModel)]="fromParasha" (change)="applyParashaFilter()">
          <option value="">בחר פרשה</option>
          <option *ngFor="let parasha of torahPortions; let i = index" [value]="i">{{parasha}} ({{i}})</option>
        </select>
      </div>

      <div class="filter-group">
        <label>עד פרשה</label>
        <select class="form-control" [(ngModel)]="toParasha" (change)="applyParashaFilter()">
          <option value="">בחר פרשה</option>
          <option *ngFor="let parasha of torahPortions; let i = index" [value]="i">{{parasha}} ({{i}})</option>
        </select>
      </div>
    </div>
  </div>

  <div class="reminders-tabs">
    <button class="tab-btn" [class.active]="activeTab === 'today'" (click)="switchTab('today')">
      {{ (i18n.terms$ | async)?.todayTab }} ({{todayReminders.length}})
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'week'" (click)="switchTab('week')">
      {{ (i18n.terms$ | async)?.weekTab }} ({{thisWeekReminders.length}})
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'overdue'" (click)="switchTab('overdue')">
      {{ (i18n.terms$ | async)?.overdueTab }} ({{overdueReminders.length}})
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'all'" (click)="switchTab('all')">
      {{ (i18n.terms$ | async)?.allTab }}
    </button>
  </div>

  <div class="reminders-table-container">
    <table class="reminders-table">
      <thead>
        <tr>
          <th>{{ (i18n.terms$ | async)?.reminderDateHeader }}</th>
          <th>{{ (i18n.terms$ | async)?.typeHeader }}</th>
          <th>{{ (i18n.terms$ | async)?.donorHeader }}</th>
          <th>{{ (i18n.terms$ | async)?.subjectHeader }}</th>
          <th>{{ (i18n.terms$ | async)?.priorityHeader }}</th>
          <!-- <th>{{ (i18n.terms$ | async)?.statusHeaderReminder }}</th> -->
          <th>{{ (i18n.terms$ | async)?.actionsHeaderReminder }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reminder of filteredReminders"
           [class.overdue]="reminder.isOverdue"
           [class.today]="reminder.isDueToday"
           [class.completed]="reminder.isCompleted">
          
          <td class="date-col">
            <div class="date-display">
              {{this.getParashaIndex(reminder.dueDate)}}
              <span class="reminder-date">{{reminder.dueDate | date:'dd/MM/yyyy'}}</span>
            </div>
          </td>
          
          <td class="type-col">
            <span class="type-badge type-{{reminder.type}}">{{getTypeText(reminder.type)}}</span>
          </td>
          
          <td class="donor-col">
            <div class="donor-info">
              <strong>{{getDonorName(reminder)}}</strong>
              <small *ngIf="reminder.relatedDonor?.phone">{{reminder.relatedDonor?.phone}}</small>
            </div>
          </td>
          
          <td class="subject-col">
            <div class="subject-info">
              <span class="subject">{{reminder.title}}</span>
              <small class="notes" *ngIf="reminder.description">{{reminder.description | slice:0:50}}<span *ngIf="reminder.description && reminder.description.length > 50">...</span></small>
            </div>
          </td>
          
          <td class="priority-col">
            <span class="priority-badge" [class]="getPriorityBadgeClass(reminder.priority)">{{getPriorityText(reminder.priority)}}</span>
          </td>
          
          <!-- <td class="status-col">
            <span class="status-badge" [class]="getStatusBadgeClass(reminder.status)">{{reminder.statusText}}</span>
          </td> -->
          
          <td class="actions">
            <button class="btn-icon btn-complete" [title]="(i18n.terms$ | async)?.markAsCompleted" *ngIf="!reminder.isCompleted" (click)="completeReminder(reminder)">✅</button>
            <button class="btn-icon btn-edit" [title]="(i18n.terms$ | async)?.editReminder" (click)="editReminder(reminder)">✏</button>
            <button class="btn-icon btn-postpone" [title]="(i18n.terms$ | async)?.snoozeReminder" *ngIf="!reminder.isCompleted" (click)="snoozeReminder(reminder, 1)">⏰</button>
            <button class="btn-icon btn-delete" [title]="(i18n.terms$ | async)?.deleteReminder" (click)="deleteReminder(reminder)">🗑</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- <div class="quick-reminders">
    <h2>{{ (i18n.terms$ | async)?.quickReminders }}</h2>
    <div class="quick-reminder-cards">
      <div class="quick-card birthdays">
        <div class="card-header">
          <span class="icon">🎂</span>
          <h3>{{ (i18n.terms$ | async)?.birthdaysThisWeek }}</h3>
        </div>
        <div class="card-body">
          <div class="birthday-item" *ngFor="let birthday of upcomingBirthdays">
            <span class="name">{{birthday.displayName}}</span>
            <span class="date">{{birthday.birthDate | date:'dd/MM'}}</span>
          </div>
        </div>
      </div>

      <div class="quick-card memorials">
        <div class="card-header">
          <span class="icon">🕯️</span>
          <h3>{{ (i18n.terms$ | async)?.yahrzeitThisWeek }}</h3>
        </div>
        <div class="card-body">
          <div class="memorial-item">
            <p>{{ (i18n.terms$ | async)?.noYahrzeitThisWeek }}</p>
          </div>
        </div>
      </div>

      <div class="quick-card donations">
        <div class="card-header">
          <span class="icon">💰</span>
          <h3>{{ (i18n.terms$ | async)?.donationCandidates }}</h3>
        </div>
        <div class="card-body">
          <div class="donation-candidate" *ngFor="let candidate of donationCandidates">
            <span class="name">{{candidate.displayName}}</span>
            <span class="last-donation">{{ (i18n.terms$ | async)?.donationCandidate }}</span>
          </div>
          <p *ngIf="donationCandidates.length === 0">{{ (i18n.terms$ | async)?.noCandidatesAvailable }}</p>
        </div>
      </div>

      <div class="quick-card meetings">
        <div class="card-header">
          <span class="icon">🤝</span>
          <h3>{{ (i18n.terms$ | async)?.meetingsThisWeek }}</h3>
        </div>
        <div class="card-body">
          <div class="meeting-item" *ngFor="let meeting of upcomingMeetings">
            <span class="name">{{getDonorName(meeting)}}</span>
            <span class="purpose">{{meeting.title}}</span>
            <span class="datetime">{{meeting.dueDate | date:'dd/MM'}}</span>
          </div>
          <p *ngIf="upcomingMeetings.length === 0">{{ (i18n.terms$ | async)?.noMeetingsThisWeek }}</p>
        </div>
      </div>
    </div>
  </div> -->

  <div class="pagination">
    <button class="btn-page">{{ (i18n.terms$ | async)?.previousPage }}</button>
    <span class="page-info">{{ (i18n.terms$ | async)?.pageOf?.replace('{current}', '1')?.replace('{total}', '12') }}</span>
    <button class="btn-page">{{ (i18n.terms$ | async)?.nextPage }}</button>
  </div>
</div>
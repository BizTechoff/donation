<!-- Donor Details Modal -->
<div class="modal-overlay">
  <div class="modal-content donor-details-modal">
    <div class="modal-header">
      <h2>{{isNewDonor ? ((i18n.terms$ | async)?.addNewDonor) : ((i18n.terms$ | async)?.donorDetails)}}</h2>
      <button class="modal-close">&times;</button>
    </div>
    
    <!-- Loading State -->
    <div class="loading-overlay" *ngIf="loading">
      <div class="loading-spinner">{{ (i18n.terms$ | async)?.loadingData }}</div>
    </div>
    
    <div class="modal-body">
      <div class="details-grid" *ngIf="donor && !loading">
        <!-- 驻专 砖 -->
        <div class="section personal-details">
          <h3>{{ (i18n.terms$ | async)?.personalDetails }}</h3>
          <div class="form-grid">
            <!-- 砖专 专砖: 转专, 砖 驻专, 砖 砖驻, 住转 -->
            <div class="form-group">
              <label>转专</label>
              <input type="text" class="form-control" [(ngModel)]="donor.title" placeholder="转专 (: 专, &quot;专)">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.firstName }} *</label>
              <input type="text" class="form-control" [(ngModel)]="donor.firstName" [placeholder]="(i18n.terms$ | async)?.firstName">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.lastName }} *</label>
              <input type="text" class="form-control" [(ngModel)]="donor.lastName" [placeholder]="(i18n.terms$ | async)?.lastName">
            </div>
            <div class="form-group">
              <label>住转</label>
              <input type="text" class="form-control" [(ngModel)]="donor.suffix" placeholder="住转 (: &quot;)">
            </div>
            
            <!-- 砖专 砖: , 砖 转 -->
            <div class="form-group">
              <label></label>
              <input type="text" class="form-control" [(ngModel)]="donor.nickname" placeholder="">
            </div>
            <div class="form-group">
              <label>砖 驻专 转</label>
              <input type="text" class="form-control" [(ngModel)]="donor.firstNameEnglish" placeholder="First Name">
            </div>
            <div class="form-group">
              <label>砖 砖驻 转</label>
              <input type="text" class="form-control" [(ngModel)]="donor.lastNameEnglish" placeholder="Last Name">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.idNumber }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.idNumber" [placeholder]="(i18n.terms$ | async)?.idNumber">
            </div>
            
            <!-- 砖专 砖砖转: &quot;, 驻 -->
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.email }}</label>
              <input type="email" class="form-control" [(ngModel)]="donor.email" [placeholder]="(i18n.terms$ | async)?.email">
            </div>
            <div class="form-group">
              <label>拽转 转</label>
              <select class="form-control" [(ngModel)]="donor.internationalPrefix">
                <option value="+972">+972 (砖专)</option>
                <option value="+1">+1 (专&quot;/拽)</option>
                <option value="+44">+44 (专)</option>
                <option value="+33">+33 (爪专驻转)</option>
                <option value="+49">+49 (专)</option>
              </select>
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.phone }}</label>
              <input type="tel" class="form-control" [(ngModel)]="donor.phone" [placeholder]="(i18n.terms$ | async)?.phone">
            </div>
            <div class="form-group">
              <label>驻 住祝</label>
              <input type="tel" class="form-control" [(ngModel)]="donor.additionalPhone" placeholder="驻 住祝">
            </div>
            
            <!-- Birth Date with Modern Hebrew-Gregorian picker -->
            <div class="form-group full-width">
              <app-modern-dual-date-picker
                [(ngModel)]="donor.birthDate"
                [label]="(i18n.terms$ | async)?.birthDate || '转专 '"
                (dateChange)="onDateChange('birthDate', $event)">
              </app-modern-dual-date-picker>
            </div>
          </div>
        </div>
        
        <!-- 转转 专 -->
        <div class="section address-section">
          <h3>转转 专</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>专 1</label>
              <input type="text" class="form-control" [(ngModel)]="donor.street1" placeholder="专 住驻专">
            </div>
            <div class="form-group">
              <label>专 2</label>
              <input type="text" class="form-control" [(ngModel)]="donor.street2" placeholder="住/专">
            </div>
            <div class="form-group">
              <label>砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.neighborhood" placeholder="砖">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.city }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.city" [placeholder]="(i18n.terms$ | async)?.city">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.zipCode }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.zipCode" [placeholder]="(i18n.terms$ | async)?.zipCode">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.country }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.country" [placeholder]="(i18n.terms$ | async)?.country">
            </div>
          </div>
        </div>
        
        <!-- 转转 驻砖 -->
        <div class="section vacation-address-section">
          <h3>转转 驻砖</h3>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>转转 驻砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.vacationAddress" placeholder="转转 ">
            </div>
            <div class="form-group">
              <label>注专 驻砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.vacationCity" placeholder="注专">
            </div>
            <div class="form-group">
              <label>拽 驻砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.vacationZipCode" placeholder="拽">
            </div>
            <div class="form-group">
              <label> 驻砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.vacationCountry" placeholder="">
            </div>
          </div>
        </div>

        <!-- 注 砖驻转 -->
        <div class="section family-info">
          <h3>{{ (i18n.terms$ | async)?.familyInformation }}</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>转专 砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.wifeTitle" placeholder="转专 砖">
            </div>
            <div class="form-group">
              <label>砖 砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.wifeName" placeholder="砖 砖">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.spouseName }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.spouseName" [placeholder]="(i18n.terms$ | async)?.spouseName">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.maritalStatus }}</label>
              <select class="form-control" [(ngModel)]="donor.maritalStatus">
                <option value="">{{ (i18n.terms$ | async)?.selectOption }}</option>
                <option value="married">{{ (i18n.terms$ | async)?.married }}</option>
                <option value="single">{{ (i18n.terms$ | async)?.single }}</option>
                <option value="widowed">{{ (i18n.terms$ | async)?.widowed }}</option>
                <option value="divorced">{{ (i18n.terms$ | async)?.divorced }}</option>
              </select>
            </div>
            <div class="form-group">
              <label>砖 </label>
              <input type="text" class="form-control" [(ngModel)]="donor.fatherName" placeholder="砖 ">
            </div>
            <div class="form-group">
              <label>砖 转</label>
              <input type="text" class="form-control" [(ngModel)]="donor.fatherInLawName" placeholder="砖 转">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.homePhone }}</label>
              <input type="tel" class="form-control" [(ngModel)]="donor.homePhone" [placeholder]="(i18n.terms$ | async)?.homePhone">
            </div>
            <div class="form-group full-width">
              <label>拽砖专 砖驻转</label>
              <input type="text" class="form-control" [(ngModel)]="donor.familyConnection" placeholder="拽砖专 砖驻转 ( 砖,  砖, 转 砖 ')">
            </div>
            <div class="form-group full-width">
              <label>注专转 拽砖专 砖驻转</label>
              <textarea class="form-control" [(ngModel)]="donor.familyConnectionNotes" placeholder="注专转 住驻转 注 拽砖专 砖驻转" rows="2"></textarea>
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.mobilePhone }}</label>
              <input type="tel" class="form-control" [(ngModel)]="donor.mobilePhone" [placeholder]="(i18n.terms$ | async)?.mobilePhone">
            </div>
          </div>
          
          <!-- 转专 砖 -->
          <div class="personal-dates-section">
            <div class="section-header">
              <h4>{{ (i18n.terms$ | async)?.personalDates || '转专 砖' }}</h4>
              <button class="mat-fab-mini" (click)="openAddDateDialog()" title="住祝 转专 转 砖转">
                <span class="fab-icon">+</span>
              </button>
            </div>
            
            <div class="dates-container" [class.scrollable]="(customPersonalDates.length + 3) > 5">
              <!-- Empty state message when no personal events exist -->
              <div *ngIf="donorEvents.length === 0 && customPersonalDates.length === 0" class="empty-events-message">
                <p> 爪 专注 砖 转专 , 住驻转 专注 砖 抓 注 +</p>
              </div>
              
              <!-- Donor Events displayed as date pickers -->
              <div *ngFor="let donorEvent of donorEvents; trackBy: trackDonorEventById" class="form-group full-width custom-date-item">
                <app-modern-dual-date-picker
                  [(ngModel)]="donorEvent.hebrewDate"
                  [label]="donorEvent.event?.description || '专注'"
                  (dateChange)="onDonorEventDateChange(donorEvent, $event)">
                </app-modern-dual-date-picker>
                <button 
                  *ngIf="!donorEvent.event?.isRequired" 
                  class="remove-date-btn" 
                  (click)="removeDonorEvent(donorEvent)" 
                  title="住专 专注">
                  
                </button>
              </div>
              
              <!-- Custom Dates -->
              <div class="form-group full-width custom-date-item" *ngFor="let customDate of customPersonalDates; let i = index">
                <app-modern-dual-date-picker
                  [(ngModel)]="customDate.date"
                  [label]="customDate.name"
                  (dateChange)="onCustomDateChange(i, $event)">
                </app-modern-dual-date-picker>
                <button class="remove-date-btn" (click)="removeCustomDate(i)" title="住专 转专">
                  
                </button>
              </div>
            </div>
          </div>

          
          <!-- Dialog for adding event or custom date -->
          <div class="custom-date-dialog" *ngIf="showAddDateDialog">
            <div class="dialog-backdrop" (click)="closeAddDateDialog()"></div>
            <div class="dialog-content events-table-dialog">
              <h4>住祝 专注  转专 转 砖转</h4>
              
              <!-- Search Section -->
              <div class="search-section">
                <div class="search-input-group">
                  <input 
                    type="text" 
                    class="form-control search-input" 
                    [(ngModel)]="eventSearchTerm"
                    placeholder="驻砖 专注...">
                  <button *ngIf="eventSearchTerm" class="clear-search-btn" (click)="clearSearch()"></button>
                </div>
                <button class="btn btn-success add-new-btn" (click)="toggleCreateNewEvent()">
                  {{ showCreateNewEvent ? '' : '+ 爪专转 专注 砖' }}
                </button>
              </div>

              <!-- Create New Event Section -->
              <div class="create-event-section" *ngIf="showCreateNewEvent">
                <h5>爪专转 专注 砖:</h5>
                <div class="new-event-form">
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="newEventDescription"
                    placeholder="转专 专注 砖..."
                    (keyup.enter)="createNewEvent()">
                  <button class="btn btn-primary" (click)="createNewEvent()" [disabled]="!newEventDescription.trim()">
                    爪专 砖专
                  </button>
                </div>
              </div>

              <!-- Events Table -->
              <div class="events-table-section" *ngIf="!showCreateNewEvent">
                <div class="events-table-container">
                  <table class="events-table" *ngIf="getFilteredEvents().length > 0">
                    <thead>
                      <tr>
                        <th>转专 专注</th>
                        <th>驻注转</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let event of getFilteredEvents()">
                        <td>{{ event.description }}</td>
                        <td>
                          <button class="btn btn-small btn-primary" (click)="addEventFromDialog(event)">
                            专
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  
                  <!-- Empty state when no events found -->
                  <div class="no-events-found" *ngIf="getFilteredEvents().length === 0">
                    <p *ngIf="eventSearchTerm"> 爪 专注 转 驻砖 "{{ eventSearchTerm }}"</p>
                    <p *ngIf="!eventSearchTerm"> 专注 </p>
                    <button class="btn btn-primary" (click)="toggleCreateNewEvent()">爪专 专注 砖</button>
                  </div>
                </div>
              </div>

              <!-- Legacy Custom Date Section -->
              <div class="custom-date-section" *ngIf="!showCreateNewEvent">
                <div class="divider"></div>
                <h5>住祝 转专 转 砖转:</h5>
                <input 
                  type="text" 
                  class="form-control" 
                  [(ngModel)]="newDateName" 
                  placeholder="砖 专注 (:  转 )"
                  (keyup.enter)="addCustomDate()">
                <button class="btn btn-secondary" (click)="addCustomDate()" [disabled]="!newDateName.trim()">
                  住祝 转专 转
                </button>
              </div>
              
              <div class="dialog-actions">
                <button class="btn btn-secondary" (click)="closeAddDateDialog()">住专</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 专转 注转转 -->
        <div class="section company-organization">
          <div class="section-header">
            <h3>专转 注转转</h3>
            <button class="btn btn-success btn-sm" (click)="addCompany()" title="住祝 专/注转">
              + 住祝 专/注转
            </button>
          </div>
          
          <!-- Empty state message when no companies exist -->
          <div *ngIf="!donor.companies || donor.companies.length === 0" class="empty-message">
            <p> 爪 专转  注转转 转专 . 住驻转 专/注转 砖 抓 注 驻转专 注.</p>
          </div>
          
          <!-- Companies list -->
          <div *ngFor="let company of donor.companies; let i = index; trackBy: trackByCompanyId" class="company-item">
            <div class="company-header">
              <h4>专/注转 {{i + 1}}</h4>
              <button class="btn btn-danger btn-sm" (click)="removeCompany(i)" title="住专 专">
                 住专
              </button>
            </div>
            
            <div class="form-grid">
              <div class="form-group">
                <label>砖 专/注转</label>
                <input type="text" class="form-control" [(ngModel)]="company.name" placeholder="砖 专  注转">
              </div>
              <div class="form-group">
                <label>住驻专 专/注转</label>
                <input type="text" class="form-control" [(ngModel)]="company.number" placeholder="住驻专 专砖">
              </div>
              <div class="form-group">
                <label>转驻拽</label>
                <input type="text" class="form-control" [(ngModel)]="company.role" placeholder="转驻拽 专/注转">
              </div>
              <div class="form-group">
                <label>转专 专</label>
                <input type="text" class="form-control" [(ngModel)]="company.website" placeholder="转转 转专 专">
              </div>
            </div>
            
            <h5>转转 专/注转</h5>
            <div class="form-grid">
              <div class="form-group">
                <label>专 1</label>
                <input type="text" class="form-control" [(ngModel)]="company.street1" placeholder="专 住驻专">
              </div>
              <div class="form-group">
                <label>专 2</label>
                <input type="text" class="form-control" [(ngModel)]="company.street2" placeholder="住/拽/砖专">
              </div>
              <div class="form-group">
                <label>砖</label>
                <input type="text" class="form-control" [(ngModel)]="company.neighborhood" placeholder="砖">
              </div>
              <div class="form-group">
                <label>注专</label>
                <input type="text" class="form-control" [(ngModel)]="company.city" placeholder="注专">
              </div>
              <div class="form-group">
                <label>拽</label>
                <input type="text" class="form-control" [(ngModel)]="company.zipCode" placeholder="拽">
              </div>
              <div class="form-group">
                <label></label>
                <input type="text" class="form-control" [(ngModel)]="company.country" placeholder="">
              </div>
              <div class="form-group">
                <label>驻</label>
                <input type="tel" class="form-control" [(ngModel)]="company.phone" placeholder="驻 专/注转">
              </div>
              <div class="form-group">
                <label>"</label>
                <input type="email" class="form-control" [(ngModel)]="company.email" placeholder="状 专/注转">
              </div>
            </div>
          </div>
        </div>

        <!-- 拽专转 专转 -->
        <div class="section categories-levels">
          <h3>拽专转 专转</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.level }}</label>
              <select class="form-control" [(ngModel)]="donor.level">
                <option value="">{{ (i18n.terms$ | async)?.selectOption }}</option>
                <option value="platinum">{{ (i18n.terms$ | async)?.platinum }}</option>
                <option value="gold">{{ (i18n.terms$ | async)?.gold }}</option>
                <option value="silver">{{ (i18n.terms$ | async)?.silver }}</option>
                <option value="regular">{{ (i18n.terms$ | async)?.regular }}</option>
              </select>
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.circle }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.circle" [placeholder]="(i18n.terms$ | async)?.circle">
            </div>
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.preferredLanguage }}</label>
              <select class="form-control" [(ngModel)]="donor.preferredLanguage">
                <option value="he">{{ (i18n.terms$ | async)?.hebrew }}</option>
                <option value="en">{{ (i18n.terms$ | async)?.english }}</option>
                <option value="ar">{{ (i18n.terms$ | async)?.arabic }}</option>
              </select>
            </div>
          </div>
          
          <h4>驻 转专</h4>
          <div class="form-grid">
            <div class="form-group full-width">
              <label>住 转专</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.isAnash">
                  "砖
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.isAlumni">
                  专
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.isOtherConnection" (change)="onOtherConnectionChange()">
                  拽砖专 专
                </label>
              </div>
            </div>
            
            <!-- Show relationship fields only when "拽砖专 专" is checked -->
            <div class="form-group" *ngIf="donor.isOtherConnection">
              <label>住 拽砖专</label>
              <input type="text" class="form-control" [(ngModel)]="donor.relationshipType" 
                     placeholder=" / 住 /  / 专...">
            </div>
            
            <div class="form-group" *ngIf="donor.isOtherConnection">
              <label>拽砖专 砖</label>
              <input type="text" class="form-control" [(ngModel)]="donor.relationshipOf" 
                     placeholder="砖  砖转专 拽砖专 ">
            </div>
            
            <div class="form-group full-width">
              <label>专砖</label>
              <textarea class="form-control" [(ngModel)]="donor.interests" 
                        placeholder="砖 砖注 转 转专" rows="2"></textarea>
            </div>
            
            <div class="form-group full-width">
              <label>转</label>
              <textarea class="form-control" [(ngModel)]="donor.hobbies" 
                        placeholder="转 驻注转 驻" rows="2"></textarea>
            </div>
          </div>
        </div>

        <!-- 注驻转 爪专转 拽砖专 -->
        <div class="section contact-preferences">
          <h3>{{ (i18n.terms$ | async)?.contactPreferences }}</h3>
          <div class="form-grid">
            <div class="form-group">
              <label>{{ (i18n.terms$ | async)?.receptionHours }}</label>
              <input type="text" class="form-control" [(ngModel)]="donor.receptionHours" [placeholder]="(i18n.terms$ | async)?.receptionHours">
            </div>
            <div class="form-group full-width">
              <label>{{ (i18n.terms$ | async)?.preferredDays }}</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.sundayAvailable">
                  {{ (i18n.terms$ | async)?.sunday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.mondayAvailable">
                  {{ (i18n.terms$ | async)?.monday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.tuesdayAvailable">
                  {{ (i18n.terms$ | async)?.tuesday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.wednesdayAvailable">
                  {{ (i18n.terms$ | async)?.wednesday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.thursdayAvailable">
                  {{ (i18n.terms$ | async)?.thursday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.fridayAvailable">
                  {{ (i18n.terms$ | async)?.friday }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.saturdayAvailable">
                  {{ (i18n.terms$ | async)?.saturday }}
                </label>
              </div>
            </div>
            <div class="form-group full-width">
              <label>{{ (i18n.terms$ | async)?.preferredContactMethods }}</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferPhone">
                  {{ (i18n.terms$ | async)?.phoneContact }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferEmail">
                  {{ (i18n.terms$ | async)?.emailContact }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferSMS">
                  {{ (i18n.terms$ | async)?.smsContact }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferHomeVisit">
                  {{ (i18n.terms$ | async)?.homeVisit }}
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferOfficeVisit">
                  {{ (i18n.terms$ | async)?.officeVisit }}
                </label>
              </div>
            </div>
            <div class="form-group full-width">
              <label>驻 爪专转 拽砖专</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.requirePhoneCoordination">
                  转 驻
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferSpecialTimes">
                   : 驻住/住转
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.preferPublicReception">
                  拽转 拽
                </label>
              </div>
            </div>
            
            <div class="form-group full-width">
              <label>注驻转 住驻转</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.emailOnlyCorrespondence">
                  砖转 转  
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" [(ngModel)]="donor.autoAddToLocationEvents">
                  住驻 转 专注 (驻 拽)
                </label>
              </div>
            </div>
            
            <!-- Action buttons section -->
            <div class="form-group full-width">
              <label>驻注转 专转</label>
              <div class="action-buttons">
                <button class="btn btn-outline-primary" (click)="openGifts()" title="转转">
                   转转
                </button>
                <button class="btn btn-outline-success" (click)="openDonations()" title="转专转">
                   转专转
                </button>
                <button class="btn btn-outline-info" (click)="openReceipts()" title="爪转 拽转">
                   "拽
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- 注驻转 转 -->
        <div class="section preferences">
          <h3>{{ (i18n.terms$ | async)?.generalPreferences }}</h3>
          <div class="form-grid">
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" [(ngModel)]="donor.wantsUpdates">
                {{ (i18n.terms$ | async)?.wantsUpdates }}
              </label>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" [(ngModel)]="donor.wantsTaxReceipts">
                {{ (i18n.terms$ | async)?.wantsTaxReceipts }}
              </label>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" [(ngModel)]="donor.isActive">
                {{ (i18n.terms$ | async)?.active }}
              </label>
            </div>
            <div class="form-group full-width">
              <label>{{ (i18n.terms$ | async)?.generalNotes }}</label>
              <textarea class="form-control" rows="4" [(ngModel)]="donor.notes" [placeholder]="(i18n.terms$ | async)?.enterNotesPlaceholder"></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary">{{ (i18n.terms$ | async)?.cancel }}</button>
      <button class="btn btn-danger" *ngIf="!isNewDonor && donor?.isActive" (click)="deactivateDonor()">{{ (i18n.terms$ | async)?.deactivate }}</button>
      <button class="btn btn-success" *ngIf="!isNewDonor && !donor?.isActive" (click)="activateDonor()">{{ (i18n.terms$ | async)?.activate }}</button>
      <button class="btn btn-danger" *ngIf="!isNewDonor" (click)="deleteDonor()">{{ (i18n.terms$ | async)?.delete }}</button>
      <button class="btn btn-primary" (click)="saveDonor()">{{ (i18n.terms$ | async)?.saveDonor }}</button>
    </div>
  </div>
</div>